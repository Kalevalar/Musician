<Ui xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.blizzard.com/wow/ui/">

	<!-- Icon fonts -->

	<Font name="MusicianFontIconsNormal" inherits="GameFontNormal" font="Interface\AddOns\Musician\ui\fonts\fontello.ttf" height="12" virtual="true" />
	<Font name="MusicianFontIconsHighlight" inherits="GameFontHighlight" font="Interface\AddOns\Musician\ui\fonts\fontello.ttf" height="12" virtual="true" />
	<Font name="MusicianFontIconsDisable" inherits="GameFontDisable" font="Interface\AddOns\Musician\ui\fonts\fontello.ttf" height="12" virtual="true" />
	<Font name="MusicianFontNormalLarge" inherits="GameFontNormalLarge" font="Interface\AddOns\Musician\ui\fonts\fontello.ttf" height="16" virtual="true" />
	<Font name="MusicianFontHighlightLarge" inherits="GameFontHighlightLarge" font="Interface\AddOns\Musician\ui\fonts\fontello.ttf" height="16" virtual="true" />

	<!-- Standard button with icon font template -->

	<Button name="MusicianIconButton" inherits="UIPanelButtonTemplate" virtual="true">
		<NormalFont style="MusicianFontIconsNormal" />
		<HighlightFont style="MusicianFontIconsHighlight" />
		<DisabledFont style="MusicianFontIconsDisable" />
	</Button>

	<!-- Dropdown menu with tooltip -->

	<Frame name="MusicianDropDownMenuTooltipTemplate" inherits="UIDropDownMenuTemplate" virtual="true">
		<Scripts>
			<OnEnter>
				if(self.tooltipText ~= nil) then
					GameTooltip_AddNewbieTip(self, self.tooltipText, 1.0, 1.0, 1.0, self.newbieText);
				end
			</OnEnter>
			<OnLeave>
				if(self.tooltipText ~= nil) then
					GameTooltip:Hide();
				end
			</OnLeave>
		</Scripts>
	</Frame>
	<Frame name="MusicianDropDownMenuTooltipTemplate" inherits="MusicianDropDownMenuTooltipTemplate" />

	<!-- Instrument dropdown -->

	<Frame name="MusicianInstrumentDropdownTemplate" inherits="MusicianDropDownMenuTooltipTemplate" virtual="true">
		<Scripts>
			<OnLoad>
				UIDropDownMenu_SetWidth(self, 115)
				local dropdown = self

				dropdown.value = nil

				dropdown.SetValue = function(value)
					local originalMidiId = value
					local instrumentId = Musician.MIDI_INSTRUMENT_MAPPING[originalMidiId]
					local midiId = Musician.INSTRUMENTS[instrumentId].midi
					local instrumentName = Musician.Msg.INSTRUMENT_NAMES[instrumentId]
					dropdown.value = midiId

					if Musician.INSTRUMENTS[instrumentId].color ~= nil then
						local r, g, b = unpack(Musician.INSTRUMENTS[instrumentId].color)
						instrumentName = Musician.Utils.GetColorCode(unpack(Musician.INSTRUMENTS[instrumentId].color)) .. instrumentName .. "|r"
					end

					UIDropDownMenu_SetText(dropdown, instrumentName)

					if dropdown.OnChange then
						dropdown.OnChange(midiId, instrumentId)
					end
				end

				dropdown.OnClick = function(self, arg1, arg2, checked)
					dropdown.SetValue(arg1)
				end

				dropdown.GetItems = function(frame, level, menuList)
					local info = UIDropDownMenu_CreateInfo()
					info.func = dropdown.OnClick

					local instrumentId
					for _, instrumentId in pairs(Musician.INSTRUMENTS_AVAILABLE) do
						local midiId = Musician.INSTRUMENTS[instrumentId].midi
						info.text = Musician.Msg.INSTRUMENT_NAMES[instrumentId]
						info.arg1 = midiId
						info.checked = dropdown.value == midiId
						if Musician.INSTRUMENTS[instrumentId].color ~= nil then
							info.colorCode = Musician.Utils.GetColorCode(unpack(Musician.INSTRUMENTS[instrumentId].color))
						end
						UIDropDownMenu_AddButton(info)
					end
				end

				UIDropDownMenu_Initialize(dropdown, dropdown.GetItems)
			</OnLoad>
		</Scripts>
	</Frame>
	<Frame name="MusicianInstrumentDropdownTemplate" inherits="MusicianInstrumentDropdownTemplate" />

</Ui>